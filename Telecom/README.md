# Прогнозирование отттока клиентов для телекома

[ipynb](https://github.com/NatalyaSe/portfolio/blob/master/Telecom/telecom_classif.ipynb)

## Описание проекта

Оператор связи хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. 
Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

## Навыки и инструменты

- **python**
- **pandas**
- **numpy**
- sklearn.metrics **roc_auc_score, roc_curve, accuracy_score, confusion_matrix, f1_score**
- sklearn.preprocessing **OneHotEncoder,OrdinalEncoder,StandardScaler**
- sklearn.linear_model.**LogisticRegression**
- sklearn.ensemble.**RandomForestClassifier**
- catboost.**CatBoostClassifier**


## Вывод

Наша задача состояла в том, чтобы предсказать, откажется ли клиент от услуг оператора, ведь в таком случае мы можем заранее предложить ему промокоды и спецпредложения.
Все пункты плана были выполнены, а именно:

* Изменили некоторые типы данных в таблице
* Объединили таблицы по customer id, никакие данные не потеряли, там где пропуски, стоит Nan
* Заполнили пропуски
* Выделили целевой признак Exited и добавили новый столбец Time - сколько дней человек пользуется услушами компании. Удалили столбцы BeginDate,EndTime,MonthCharges так как у них есть корреляция с добавленными столбцами
* Проанализированы количественные и категоральные признаки, проведена попытка найти связь между ними и целевым признаком. Получили, что со временем вероятность отказа от услуг снижается и обычно отказывались от услуг те, кто платил больше
* Разделили данные на выборки c test_size = 0.25
* Применили к выборками OHE для категориальных данных для линейной модели и модели случайного леса
* Применили масштабирование численных данных для линейной модели
* С помощью GridSearch подобрали лучшие гиперпараметры для LogisticRegressor RandomForestClassifier, CatBoostClassifier
* Лучшей моделью стал **CatBoostClassifier** со значением целевой метрики AUC ROC=0.9 на кросс валидации и гиперпараметрами 'depth': 5, 'learning_rate': 0.1 , время обучения составило 8 минут
* Протестировали лучшую модель. **Результаты: AUC ROC=0.92**
* Важность признаков модели позволяет сделать следующий вывод: на лояльность клиентов влияет время использования услуг. Как правило, чем дольше мы пользуемся услугами компании, тем меньше вероятность что мы уже уйдем оттуда.
  Второй признак - суммарные расходы, что логично, ведь получается, что человек тоже долго является абонентом сотового оператора.
  Третий признак - тип оплаты(ежемесячный, годовой)
  Затем идут признаки, отвечающие за способ оплаты, наличие интернета и т.д.
